<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<ui:composition template="../template.xhtml">
    <ui:define name="content-center">
        <h1 style="text-align: center;">Car Scans</h1>
        <f:metadata>
            <f:event listener="#{odsCarScansController.onPageLoad()}" type="preRenderView" />
        </f:metadata>
        <h:form id ="odsCarScans">
            <p:growl id="msgs" showDetail="true"/>
            <p:dataTable id="dataTableOdsCarScans" var="carScans" value="#{odsCarScansController.odsCarScansList}"
                         selection="#{odsCarScansController.odsCarScans}"
                         emptyMessage="No car scans found with given criteria"
                         showGridlines="true"
                         rows="5" paginator="true" paginatorPosition="bottom"
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                         rowsPerPageTemplate="5,10,15,25,50,100,{ShowAll|'All'}">
                <f:facet name="header">
                    <div class="flex justify-content-between align-items-center">
                        List of Car Scans
                    </div>
                </f:facet>

                <p:column headerText="ID" sortBy="#{carScans.id}">
                    <h:outputText value="#{carScans.id}" />
                </p:column>

                <p:column headerText="First picture">
                    <p:commandButton value="Show" actionListener="#{odsCarScansController.settingImage(carScans.id, 1)}" update="carScanImage"
                                     oncomplete="PF('carScanPicture').show()"/>
                </p:column>

                <p:column headerText="Second picture">
                    <p:commandButton value="Show" actionListener="#{odsCarScansController.settingImage(carScans.id, 2)}" update="carScanImage"
                                     oncomplete="PF('carScanPicture').show()"/>
                </p:column>

                <p:column headerText="Third picture">
                    <p:commandButton value="Show" actionListener="#{odsCarScansController.settingImage(carScans.id, 3)}" update="carScanImage"
                                     oncomplete="PF('carScanPicture').show()"/>
                </p:column>
                <p:column headerText="Number of Passengers" >
                    <h:outputText value="#{carScans.numberOfPassengers}" />
                </p:column>
            </p:dataTable>
        </h:form>
        <h:form id ="carScanImage">
            <p:dialog id="carScanPicture" header="Car Picture" widgetVar="carScanPicture" responsive="true" showEffect="fade" position="center">
                <p:outputLabel id="manage-carScanPicture-content" class = "ui-fluid">
                    <p:outputLabel rendered="#{not empty odsCarScansController.imageFromDB}">
                        <p:graphicImage
                                cache="false"
                                value="#{odsCarScansController.imageDB}"
                                style="max-width: 358px; max-height: 358px"
                        />
                    </p:outputLabel>
                </p:outputLabel>
                <f:facet name="footer">
                    <p:commandButton value="Cancel" icon="pi pi-times" onclick="PF('carScanPicture').hide()"
                                     class = "ui-button-secondary" type = "button" />
                </f:facet>
            </p:dialog>
        </h:form>

    </ui:define>
</ui:composition>
</html>
