<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<ui:composition template="../template.xhtml">
    <ui:define name="content-center">
        <h2 style="text-align: center;">Verify status</h2>
        <f:metadata>
            <f:event listener="#{workflowManagementController.onPageLoad}" type="preRenderView" />
        </f:metadata>

        <h:form  id="form" >
            <p:growl id="msgs" showDetail="true" skipDetailIfEqualsSummary="true"/>
            <h:outputLabel  value="To see the "   style="margin-left: 5px"/>

            <p:selectOneMenu id="workflowsActive" value="#{workflowManagementController.nameOfSelectedWorkflowInstanceActive}"
                             filter="true" filterMatchMode="contains" filterNormalize="true" autoWidth="true" style="vertical-align: middle!important;" >
                <p:ajax listener="#{workflowManagementController.onWorkflowChange}" update="diagram"/>
                <f:selectItem itemLabel="Select Workflow" itemValue="" noSelectionOption="true"/>
                <f:selectItems value="#{workflowManagementController.odsWorkflowsListForBCP}"
                               var="w" itemValue="#{w.workflowName}"/>
            </p:selectOneMenu>

            <h:outputLabel  value=" workflow, click on the button    "   style="margin-left: 5px"/>

            <p:commandButton value="Show Workflow" actionListener="#{workflowManagementController.createDiagramForBCP()}" update="diagram"
                             widgetVar="showButton"
                             onclick="PF('showButton').disable()" >
            </p:commandButton>

            <style type="text/css">
                .my-box-blue {
                    border:1px solid #aaa;
                    width:330px;
                    height:60px;
                    background:#0000ff;
                    text-align: center ;
                    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4);
                }
                .my-box-orange {
                    border:1px solid #aaa;
                    width:330px;
                    height:60px;
                    background: #ff9900;
                    text-align: center;
                    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4);
                }
                .flow-label {
                    font-size: 24px;
                    font-weight: bold;
                    color: #C34A2C;
                }
            </style>
            <div class="card">
                <p:diagram id="diagram" var="diag" value="#{workflowManagementController.modelForBCP}" rendered="#{not empty workflowManagementController.modelForBCP}"  style="height:800px; width: 800px;" styleClass="ui-widget-content">
                </p:diagram>
                <p:remoteCommand name="elementClicked" actionListener="#{workflowManagementController.elementSelectedForBCP()}"/>
                <script type="text/javascript">
                    $(document).on('click', '.ui-diagram > .ui-diagram-element', function(info){
                        elementClicked([ {
                            name : 'elementId',
                            value : info.target.id
                        } ]);
                    });
                </script>
            </div>


        </h:form>

        <h:form id="elementDetailsBCP">
            <p:dialog id="dialogElementDetailsBCP" header="Node Details" widgetVar="dialogElementDetailsBCP" responsive="true" showEffect="fade">
                <p:outputPanel id="manage-elementBCP-content" class="ui-fluid">
                    <p:outputPanel rendered="#{not empty workflowManagementController.selectedNode}">
                        <div class="field">
                            <p:outputLabel for="nodeName">Node Name</p:outputLabel>
                            <p:inputText id="nodeName" readonly="true"
                                         value="#{workflowManagementController.selectedNode.nodeName}"/>
                        </div>

                        <div class="field">
                            <p:outputLabel for="nodeText">Description</p:outputLabel>
                            <p:inputTextarea id="nodeText" readonly="true" rows="4"
                                             value="#{workflowManagementController.selectedNode.nodeText}"/>
                        </div>


                        <div class="field">
                            <p:outputLabel for="createdOn">Created on</p:outputLabel>
                            <p:inputText id="createdOn" readonly="true"
                                         value="#{workflowManagementController.selectedNode.createdOn}"/>
                        </div>

                        <div class="field">
                            <p:outputLabel for="numberOfActiveNodeInstance">Number of instance nodes active</p:outputLabel>
                            <p:inputText id="numberOfActiveNodeInstance" readonly="true"
                                         value="#{workflowManagementController.numberOfActiveNodeInstance}"/>
                        </div>

                        <div class="field">
                            <p:outputLabel for="totalNodeInstance">Number of total instance nodes</p:outputLabel>
                            <p:inputText id="totalNodeInstance" readonly="true"
                                         value="#{workflowManagementController.totalNodeInstance}"/>
                        </div>

                    </p:outputPanel>
                </p:outputPanel>
                <f:facet name="footer">
                    <p:commandButton value="Cancel" icon="pi pi-times" onclick="PF('dialogElementDetailsBCP').hide()"
                                     class="ui-button-secondary" type="button" />
                </f:facet>
            </p:dialog>

        </h:form>


    </ui:define>

</ui:composition>
</html>
